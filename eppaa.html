<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Galeri Motif Tenun Sulawesi Selatan</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      overflow: hidden;
      background: #0f172a;
    }

    #container {
      width: 100vw;
      height: 100vh;
    }

    .header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      z-index: 10;
      background: linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent);
      padding: 24px;
      text-align: center;
    }

    .header h1 {
      color: white;
      font-size: 2.5rem;
      margin-bottom: 8px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    .region-title {
      color: #fbbf24;
      font-size: 1.5rem;
      margin-bottom: 8px;
      font-weight: bold;
    }

    .header p {
      color: #d1d5db;
      font-size: 0.875rem;
    }

    #loading {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #0f172a;
      color: white;
      font-size: 1.25rem;
      z-index: 100;
    }

    #loading.hidden {
      display: none;
    }

    #description-panel {
      position: absolute;
      bottom: 24px;
      right: 24px;
      width: 384px;
      max-width: calc(100vw - 48px);
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(251, 191, 36, 0.5);
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.3s ease;
      pointer-events: none;
    }

    #description-panel.visible {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    #description-panel h2 {
      color: #fbbf24;
      font-size: 1.5rem;
      margin-bottom: 12px;
    }

    #description-panel p {
      color: #e5e7eb;
      line-height: 1.6;
    }

    .color-info {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 16px;
    }

    .color-box {
      width: 32px;
      height: 32px;
      border-radius: 4px;
      border: 2px solid rgba(255, 255, 255, 0.5);
    }

    .color-label {
      color: #9ca3af;
      font-size: 0.875rem;
    }

    .nav-button {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 60px;
      height: 60px;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(251, 191, 36, 0.5);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 20;
      font-size: 24px;
      color: #fbbf24;
    }

    .nav-button:hover {
      background: rgba(251, 191, 36, 0.2);
      border-color: #fbbf24;
      transform: translateY(-50%) scale(1.1);
    }

    .nav-button.left {
      left: 24px;
    }

    .nav-button.right {
      right: 24px;
    }

    #controls-info {
      position: absolute;
      bottom: 24px;
      left: 24px;
      max-width: 320px;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 8px;
      padding: 16px;
      color: white;
      font-size: 0.875rem;
      border: 1px solid rgba(251, 191, 36, 0.3);
    }

    #controls-info h3 {
      font-weight: bold;
      margin-bottom: 8px;
      color: #fbbf24;
    }

    #controls-info ul {
      list-style: none;
      color: #d1d5db;
    }

    #controls-info li {
      margin-bottom: 4px;
    }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 1.5rem;
      }

      .region-title {
        font-size: 1.25rem;
      }

      #description-panel {
        left: 24px;
        right: 24px;
        width: auto;
        bottom: 120px;
      }

      .nav-button {
        width: 50px;
        height: 50px;
        font-size: 20px;
      }

      #controls-info {
        font-size: 0.75rem;
        max-width: calc(100vw - 48px);
      }
    }
  </style>
</head>

<body>
  <!-- Header -->
  <div class="header">
    <h1>Galeri Motif Tenun Sulawesi Selatan</h1>
    <div class="region-title" id="region-name">Toraja</div>
    <p>Klik motif untuk zoom & lihat detail ‚Ä¢ Klik area kosong untuk zoom out</p>
  </div>

  <!-- Navigation Buttons -->
  <div class="nav-button left" id="prev-btn">‚óÄ</div>
  <div class="nav-button right" id="next-btn">‚ñ∂</div>

  <!-- 3D Canvas Container -->
  <div id="container"></div>

  <!-- Loading Screen -->
  <div id="loading">Memuat galeri...</div>

  <!-- Description Panel -->
  <div id="description-panel">
    <h2 id="motif-name"></h2>
    <p id="motif-description"></p>
    <div class="color-info">
      <div class="color-box" id="color-box"></div>
      <span class="color-label">Warna Dominan</span>
    </div>
  </div>

  <!-- Controls Info -->
  <div id="controls-info">
    <h3>Navigasi:</h3>
    <ul>
      <li>‚óÄ‚ñ∂ Pindah daerah</li>
      <li>üñ±Ô∏è Klik motif = Zoom + detail</li>
      <li>üñ±Ô∏è Klik kosong = Zoom out</li>
      <li>üëÜ Hover = Highlight</li>
    </ul>
  </div>

  <script>
    // Data motif untuk setiap daerah
    const regions = {
      toraja: {
        name: "Toraja",
        motifs: [
          {
            id: 1,
            name: "Pa'tedong",
            description: "Motif geometris berbentuk belah ketupat yang melambangkan kesuburan dan kehidupan. Sering digunakan dalam upacara adat Toraja.",
            color: '#8B4513',
            imageUrl: 'asset/Pa\'tedong.jpg'
          },
          {
            id: 2,
            name: "Pa' barre Allo",
            description: "Motif khas Mandar yang menggambarkan kekuatan ombak dan keberanian pelaut. Sering digunakan dalam upacara peluncuran perahu.",
            color: '#20B2AA',
            imageUrl: 'asset/Pa\'barre Allo.jpg'
          },
          {
            id: 3,
            name: "Pa' Papan Kandaure'",
            description: "Motif bambu yang melambangkan kekuatan dan ketahanan. Digunakan dalam kain upacara pernikahan.",
            color: '#228B22',
            imageUrl: 'asset/Pa\' Papan Kandaure.jpg'
          }
        ]
      },
      bugis: {
        name: "Bugis",
        motifs: [
          {
            id: 1,
            name: "Sobbi Tettong",
            description: "Motif bunga yang melambangkan keindahan dan keharuman. Menggambarkan kesucian dan keanggunan dalam budaya Bugis.",
            color: '#FFD700',
            imageUrl: 'asset/motiff.png'
          },
          {
            id: 2,
            name: "Balo Caca' Wali",
            description: "Motif yang menggambarkan persatuan dan kerjasama dalam masyarakat Bugis. Melambangkan ikatan kekeluargaan yang kuat.",
            color: '#FF8C00',
            imageUrl: 'asset/motif balo caca\' wali.png'
          },
          {
            id: 3,
            name: "Motif Bombang",
            description: "Motif tradisional Bugis yang menggambarkan kearifan lokal dan warisan budaya yang turun-temurun.",
            color: '#4B0082',
            imageUrl: 'asset/motif bombang.png'
          }
        ]
      },
      mandar: {
        name: "Mandar",
        motifs: [
          {
            id: 1,
            name: "Bunga",
            description: "Variasi motif Pa'tedong khas Mandar yang melambangkan kekayaan laut dan kehidupan nelayan. Motif ini mencerminkan identitas masyarakat pesisir.",
            color: '#1E90FF',
            imageUrl: 'asset/motif bunga.png'
          },
          {
            id: 2,
            name: "Sure' Salakka",
            description: "Motif tradisional Toraja yang menggambarkan keindahan alam dan kehidupan masyarakat. Sering digunakan dalam berbagai upacara adat.",
            color: '#DC143C',
            imageUrl: 'asset/sure\' salakka.png'
          },
          {
            id: 3,
            name: "Bunga Mandar",
            description: "Motif floral khas Mandar yang memadukan keindahan alam daratan dan laut. Melambangkan harmoni dan keseimbangan hidup.",
            color: '#FF69B4',
            imageUrl: 'asset/bunga siruppa.png'
          }

        ]
      }
    };

    // Global variables
    let scene, camera, renderer;
    let motifMeshes = [];
    let frameMeshes = [];
    let raycaster, mouse;
    let targetPosition = { x: 0, y: 0, z: 8 };
    let isAnimating = false;
    let container;
    let currentRegionIndex = 0;
    const regionKeys = ['toraja', 'bugis', 'mandar'];
    let isTransitioning = false;

    // DOM elements
    const loadingEl = document.getElementById('loading');
    const descriptionPanel = document.getElementById('description-panel');
    const motifNameEl = document.getElementById('motif-name');
    const motifDescriptionEl = document.getElementById('motif-description');
    const colorBoxEl = document.getElementById('color-box');
    const regionNameEl = document.getElementById('region-name');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');

    // Initialize the scene
    function init() {
      container = document.getElementById('container');

      // Setup Scene
      scene = new THREE.Scene();
      scene.background = new THREE.Color(0x0f172a);

      // Setup Camera
      camera = new THREE.PerspectiveCamera(
        75,
        container.clientWidth / container.clientHeight,
        0.1,
        1000
      );
      camera.position.set(0, 0, 8);

      // Setup Renderer
      renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(container.clientWidth, container.clientHeight);
      container.appendChild(renderer.domElement);

      // Setup Raycaster
      raycaster = new THREE.Raycaster();
      mouse = new THREE.Vector2();

      // Add Lighting
      setupLighting();

      // Create motif planes for current region
      loadRegion(regionKeys[currentRegionIndex]);

      // Add event listeners
      container.addEventListener('click', onMouseClick);
      container.addEventListener('mousemove', onMouseMove);
      window.addEventListener('resize', onWindowResize);
      prevBtn.addEventListener('click', showPrevRegion);
      nextBtn.addEventListener('click', showNextRegion);

      // Hide loading
      setTimeout(() => {
        loadingEl.classList.add('hidden');
      }, 500);

      // Start animation
      animate();
    }

    // Setup lighting
    function setupLighting() {
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
      scene.add(ambientLight);

      const pointLight = new THREE.PointLight(0xffd700, 0.8);
      pointLight.position.set(5, 5, 5);
      scene.add(pointLight);

      const pointLight2 = new THREE.PointLight(0xfbbf24, 0.4);
      pointLight2.position.set(-5, -5, 5);
      scene.add(pointLight2);
    }

    // Create texture from image file
    function createTexture(imageUrl) {
      const textureLoader = new THREE.TextureLoader();
      const texture = textureLoader.load(
        imageUrl,
        (loadedTexture) => {
          loadedTexture.needsUpdate = true;
        },
        undefined,
        (err) => {
          console.error('Error loading texture:', imageUrl, err);
        }
      );

      texture.minFilter = THREE.LinearFilter;
      texture.magFilter = THREE.LinearFilter;
      texture.wrapS = THREE.ClampToEdgeWrapping;
      texture.wrapT = THREE.ClampToEdgeWrapping;

      return texture;
    }

    // Load region motifs
    function loadRegion(regionKey) {
      // Clear existing motifs
      motifMeshes.forEach(mesh => scene.remove(mesh));
      frameMeshes.forEach(frame => scene.remove(frame));
      motifMeshes = [];
      frameMeshes = [];

      const region = regions[regionKey];
      const motifs = region.motifs;

      // Update region name
      regionNameEl.textContent = region.name;

      // Create planes for 3 motifs
      const spacing = 3.5;
      const startX = -spacing;

      motifs.forEach((motif, index) => {
        // Create plane with texture
        const texture = createTexture(motif.imageUrl);
        const geometry = new THREE.PlaneGeometry(2.5, 2.5);
        const material = new THREE.MeshStandardMaterial({
          map: texture,
          side: THREE.DoubleSide
        });
        const mesh = new THREE.Mesh(geometry, material);

        // Position horizontally
        mesh.position.x = startX + (index * spacing);
        mesh.position.y = 0;
        mesh.position.z = 0;

        // Store motif data
        mesh.userData = motif;

        // Create frame
        const frameGeometry = new THREE.BoxGeometry(2.7, 2.7, 0.15);
        const frameMaterial = new THREE.MeshStandardMaterial({
          color: 0xd97706,
          metalness: 0.5,
          roughness: 0.5
        });
        const frame = new THREE.Mesh(frameGeometry, frameMaterial);
        frame.position.copy(mesh.position);
        frame.position.z = -0.1;

        scene.add(frame);
        scene.add(mesh);
        motifMeshes.push(mesh);
        frameMeshes.push(frame);
      });
    }

    // Show previous region
    function showPrevRegion() {
      if (isTransitioning) return;
      isTransitioning = true;
      hideMotifDescription();

      currentRegionIndex = (currentRegionIndex - 1 + regionKeys.length) % regionKeys.length;

      // Fade out effect
      motifMeshes.forEach(mesh => {
        mesh.material.transparent = true;
        animateFade(mesh.material, 1, 0, () => {
          loadRegion(regionKeys[currentRegionIndex]);
          // Fade in
          motifMeshes.forEach(m => {
            m.material.opacity = 0;
            animateFade(m.material, 0, 1, () => {
              m.material.transparent = false;
              isTransitioning = false;
            });
          });
        });
      });

      // Reset camera
      targetPosition = { x: 0, y: 0, z: 8 };
      isAnimating = true;
    }

    // Show next region
    function showNextRegion() {
      if (isTransitioning) return;
      isTransitioning = true;
      hideMotifDescription();

      currentRegionIndex = (currentRegionIndex + 1) % regionKeys.length;

      // Fade out effect
      motifMeshes.forEach(mesh => {
        mesh.material.transparent = true;
        animateFade(mesh.material, 1, 0, () => {
          loadRegion(regionKeys[currentRegionIndex]);
          // Fade in
          motifMeshes.forEach(m => {
            m.material.opacity = 0;
            animateFade(m.material, 0, 1, () => {
              m.material.transparent = false;
              isTransitioning = false;
            });
          });
        });
      });

      // Reset camera
      targetPosition = { x: 0, y: 0, z: 8 };
      isAnimating = true;
    }

    // Animate fade
    function animateFade(material, from, to, callback) {
      let current = from;
      const step = (to - from) / 20;
      const interval = setInterval(() => {
        current += step;
        material.opacity = current;
        if ((step > 0 && current >= to) || (step < 0 && current <= to)) {
          material.opacity = to;
          clearInterval(interval);
          if (callback) callback();
        }
      }, 20);
    }

    // Mouse click handler
    function onMouseClick(event) {
      const rect = container.getBoundingClientRect();
      mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
      mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

      raycaster.setFromCamera(mouse, camera);
      const intersects = raycaster.intersectObjects(motifMeshes);

      if (intersects.length > 0) {
        const selected = intersects[0].object;
        showMotifDescription(selected.userData);

        // Zoom to selected motif
        targetPosition = {
          x: selected.position.x,
          y: selected.position.y,
          z: 4
        };
        isAnimating = true;
      } else {
        // Zoom out
        targetPosition = { x: 0, y: 0, z: 8 };
        isAnimating = true;
        hideMotifDescription();
      }
    }

    // Mouse move handler
    function onMouseMove(event) {
      const rect = container.getBoundingClientRect();
      mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
      mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

      raycaster.setFromCamera(mouse, camera);
      const intersects = raycaster.intersectObjects(motifMeshes);

      // Reset all scales
      motifMeshes.forEach(mesh => {
        mesh.scale.set(1, 1, 1);
      });

      // Highlight hovered motif
      if (intersects.length > 0) {
        intersects[0].object.scale.set(1.1, 1.1, 1.1);
        container.style.cursor = 'pointer';
      } else {
        container.style.cursor = 'default';
      }
    }

    // Show motif description
    function showMotifDescription(motif) {
      motifNameEl.textContent = motif.name;
      motifDescriptionEl.textContent = motif.description;
      colorBoxEl.style.backgroundColor = motif.color;
      descriptionPanel.classList.add('visible');
    }

    // Hide motif description
    function hideMotifDescription() {
      descriptionPanel.classList.remove('visible');
    }

    // Window resize handler
    function onWindowResize() {
      camera.aspect = container.clientWidth / container.clientHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(container.clientWidth, container.clientHeight);
    }

    // Animation loop
    function animate() {
      requestAnimationFrame(animate);

      // Smooth camera movement
      if (isAnimating) {
        camera.position.x += (targetPosition.x - camera.position.x) * 0.1;
        camera.position.y += (targetPosition.y - camera.position.y) * 0.1;
        camera.position.z += (targetPosition.z - camera.position.z) * 0.1;

        if (Math.abs(camera.position.z - targetPosition.z) < 0.01) {
          isAnimating = false;
        }
      }

      // Subtle rotation animation
      motifMeshes.forEach((mesh, index) => {
        mesh.rotation.z = Math.sin(Date.now() * 0.001 + index) * 0.02;
      });

      camera.lookAt(targetPosition.x, targetPosition.y, 0);
      renderer.render(scene, camera);
    }

    // Start the application
    init();
  </script>
</body>

</html>